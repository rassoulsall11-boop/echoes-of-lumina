<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>XEROX 3D</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;overflow:hidden;background:#000}
#ui{position:fixed;top:10px;left:10px;color:#0ff;font-family:monospace}
</style>
</head>
<body>

<div id="ui">XEROX 3D</div>

<script type="module">
import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.160/build/three.module.js";

// ===== SCENE =====
const scene = new THREE.Scene();
scene.fog = new THREE.Fog(0x000000, 10, 120);

// ===== CAMERA =====
const camera = new THREE.PerspectiveCamera(
  75, innerWidth/innerHeight, 0.1, 1000
);
camera.position.set(0,3,6);

// ===== RENDERER =====
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(devicePixelRatio);
document.body.appendChild(renderer.domElement);

// ===== LIGHT =====
scene.add(new THREE.AmbientLight(0x666666));
const sun = new THREE.DirectionalLight(0x88ffff, 1);
sun.position.set(10,20,10);
scene.add(sun);

// ===== PLAYER =====
const player = new THREE.Mesh(
  new THREE.BoxGeometry(1,1,1),
  new THREE.MeshStandardMaterial({color:0xffffff})
);
player.position.y = 1;
scene.add(player);

// ===== WORLD (PROCÃ‰DURAL) =====
const tiles = new Map();

function tileKey(x,z){ return x+","+z; }

function createTile(x,z){
  const geo = new THREE.BoxGeometry(10,1,10);
  const mat = new THREE.MeshStandardMaterial({
    color: Math.random()>0.7 ? 0x552266 : 0x113311
  });
  const tile = new THREE.Mesh(geo,mat);
  tile.position.set(x*10,0,z*10);
  scene.add(tile);
  tiles.set(tileKey(x,z), tile);
}

function updateWorld(){
  const px = Math.floor(player.position.x/10);
  const pz = Math.floor(player.position.z/10);
  for(let x=-4;x<=4;x++)
  for(let z=-4;z<=4;z++){
    const k = tileKey(px+x,pz+z);
    if(!tiles.has(k)) createTile(px+x,pz+z);
  }
}

// ===== CONTROLS =====
const keys = {};
onkeydown = e => keys[e.key]=true;
onkeyup   = e => keys[e.key]=false;

// ===== LOOP =====
function animate(){
  requestAnimationFrame(animate);

  if(keys.ArrowUp) player.position.z -= 0.1;
  if(keys.ArrowDown) player.position.z += 0.1;
  if(keys.ArrowLeft) player.position.x -= 0.1;
  if(keys.ArrowRight) player.position.x += 0.1;

  camera.position.x += (player.position.x - camera.position.x)*0.1;
  camera.position.z += (player.position.z + 6 - camera.position.z)*0.1;
  camera.lookAt(player.position);

  updateWorld();
  renderer.render(scene,camera);
}
animate();

onresize = ()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
};
</script>
</body>
</html>
